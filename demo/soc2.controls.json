[
  {
    "control_id": "CC.2.1",
    "framework": "SOC2",
    "intent": "Logical access to systems and data is restricted to authorized users.",
    "requirements": [
      "All access attempts must be logged with actor, resource, and decision.",
      "Deny access by default when policy evaluation is inconclusive."
    ],
    "evidence": [
      "transition_logs",
      "dig_files",
      "policy_commit"
    ],
    "validation": {
      "script": "event.event_kind == 'access' -> event.policy_decision in ['allow','deny']"
    }
  },
  {
    "control_id": "CC.7.2",
    "framework": "SOC2",
    "intent": "Security events are logged, correlated, and retained for investigation.",
    "requirements": [
      "All high-threat events must produce a SNARK status signal.",
      "Denied events must be linked to a dig and policy commit."
    ],
    "evidence": [
      "transition_logs",
      "dig_files",
      "micro_proofs"
    ],
    "validation": {
      "script": "event.event_kind == 'high_threat' -> event.snark_high_threat_merkle_status == 'ok'"
    }
  }
]